<?php namespace ZN\ViewObjects;

use ZN\IndividualStructures\IS;

class Validator implements ValidatorInterface
{
    //--------------------------------------------------------------------------------------------------------
    //
    // Author     : Ozan UYKUN <ozanbote@gmail.com>
    // Site       : www.znframework.com
    // License    : The MIT License
    // Copyright  : (c) 2012-2016, znframework.com
    //
    //--------------------------------------------------------------------------------------------------------

    //--------------------------------------------------------------------------------------------------------
    // Between -> 5.3.5
    //--------------------------------------------------------------------------------------------------------
    //
    // @param float $value
    // @param float $min
    // @param float $max
    //
    //--------------------------------------------------------------------------------------------------------
    public static function between(Float $value, Float $min, Float $max) : Bool
    {
        return self::betweenBoth($value, $min, $max, 'noboth');
    }

    //--------------------------------------------------------------------------------------------------------
    // Between Both -> 5.3.5
    //--------------------------------------------------------------------------------------------------------
    //
    // @param float $value
    // @param float $min
    // @param float $max
    //
    //--------------------------------------------------------------------------------------------------------
    public static function betweenBoth(Float $value, Float $min, Float $max, $type = 'both') : Bool
    {
        if( $min > $max )
        {
            $mmin = $min;
            $min  = $max;
            $max  = $mmin;
        }

        if( $type === 'both' )
        {
            return $value >= $min && $value <= $max;
        }

        return $value > $min && $value < $max;
    }

    //--------------------------------------------------------------------------------------------------------
    // Phone
    //--------------------------------------------------------------------------------------------------------
    //
    // @param string $data
    // @param string $pattern = NULL
    //
    //--------------------------------------------------------------------------------------------------------
    public static function phone(String $data, String $pattern = NULL) : Bool
    {
        if( $pattern !== NULL)
        {
            $phoneData = preg_replace('/([^\*])/', 'key:$1', $pattern);
            $phoneData = '/'.str_replace(['*', 'key:'], ['[0-9]', '\\'], $phoneData).'/';
        }
        else
        {
            $phoneData = '/\+*[0-9]{10,14}$/';
        }

        return (bool) preg_match($phoneData, $data);
    }

    //--------------------------------------------------------------------------------------------------------
    // Numeric
    //--------------------------------------------------------------------------------------------------------
    //
    // @param string $data
    //
    //--------------------------------------------------------------------------------------------------------
    public static function numeric($data) : Bool
    {
        return is_numeric($data);
    }

    //--------------------------------------------------------------------------------------------------------
    // Alnum
    //--------------------------------------------------------------------------------------------------------
    //
    // @param string $data
    //
    //--------------------------------------------------------------------------------------------------------
    public static function alnum(String $data) : Bool
    {
        return (bool) preg_match('/^\w+$/', $data);
    }

    //--------------------------------------------------------------------------------------------------------
    // Alpha
    //--------------------------------------------------------------------------------------------------------
    //
    // @param string $data
    //
    //--------------------------------------------------------------------------------------------------------
    public static function alpha(String $data) : Bool
    {
        return ctype_alpha($data);
    }

    //--------------------------------------------------------------------------------------------------------
    // Identity
    //--------------------------------------------------------------------------------------------------------
    //
    // @param int $no
    //
    //--------------------------------------------------------------------------------------------------------
    public static function identity($no) : Bool
    {
        if( ! is_numeric($no) || strlen($no) !== 11  )
        {
            return false;
        }

        $no = (string) $no;

        $numone     = ($no[0] + $no[2] + $no[4] + $no[6]  + $no[8]) * 7;
        $numtwo     = $no[1] + $no[3] + $no[5] + $no[7];
        $result     = $numone - $numtwo;
        $tenth      = $result % 10;
        $total      = ($no[0] + $no[1] + $no[2] + $no[3] + $no[4] + $no[5] + $no[6] + $no[7] + $no[8] + $no[9]);
        $elewenth   = $total % 10;

        if( $no[0] == 0 )
        {
            return false;
        }
        elseif( $no[9] != $tenth )
        {
            return false;
        }
        elseif( $no[10] != $elewenth )
        {
            return false;
        }
        else
        {
            return true;
        }
    }

    //--------------------------------------------------------------------------------------------------------
    // Email
    //--------------------------------------------------------------------------------------------------------
    //
    // @param string $no
    //
    //--------------------------------------------------------------------------------------------------------
    public static function email(String $data) : Bool
    {
        return IS::email($data);
    }

    //--------------------------------------------------------------------------------------------------------
    // URL
    //--------------------------------------------------------------------------------------------------------
    //
    // @param string $data
    //
    //--------------------------------------------------------------------------------------------------------
    public static function url(String $data) : Bool
    {
        return IS::url($data);
    }

    //--------------------------------------------------------------------------------------------------------
    // Special Char
    //--------------------------------------------------------------------------------------------------------
    //
    // @param string $data
    //
    //--------------------------------------------------------------------------------------------------------
    public static function specialChar(String $data) : Bool
    {
        return (bool) preg_match('/[\W]+/', $data);
    }

    //--------------------------------------------------------------------------------------------------------
    // Maxchar
    //--------------------------------------------------------------------------------------------------------
    //
    // @param string $data
    // @param int    $char
    //
    //--------------------------------------------------------------------------------------------------------
    public static function maxchar(String $data, Int $char) : Bool
    {
        return ( strlen($data) <= $char );
    }

    //--------------------------------------------------------------------------------------------------------
    // Minchar
    //--------------------------------------------------------------------------------------------------------
    //
    // @param string $data
    // @param int    $char
    //
    //--------------------------------------------------------------------------------------------------------
    public static function minchar(String $data, Int $char) : Bool
    {
        return ( strlen($data) >= $char );
    }
}
